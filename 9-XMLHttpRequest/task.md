# 課題１（質問）

### <問題>

未経験でエンジニアとして採用されて昨日から入社した新人くんに「先輩、XMLHttpRequestって何ですか？（ブラウザのアドレスバーにURLを入力して送信する）普通のHTTPリクエストと何が違うんですか？」とキラキラした目で聞かれました。新人くんに分かるように、説明してあげてください

### <回答>

javascriptを使って、ブラウザとサーバ間で通信をする方法。  
普通のHTTPリクエストと違い、ページ全体を再読み込みさせずにページの一部を更新することができる。

### <問題>

新人くんが翌週、こんなことを聞いてきました  
「先輩・・・僕、example.comっていうサイトを担当することになって。example.comのページからapi.example.com（API）に向けて、XMLHttpRequestを使ってリクエストを送信するコードを書いたんですけど、リクエストにクッキー情報が付与されないんです・・・どうしてですか？」  
新人くんのコードを見た所、送信部分はこのように記述されていました。どこに問題があるのか、説明してあげてください  
```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://api.example.com/', true);
xhr.send(null);
```

### <回答>
```
xhr.withCredentials = true;
```
別オリジンへのリクエストに認証情報を含める場合は上記のコードを足せば良い  
また、サーバ側でも認証情報を扱うためには、送信元のドメインを指定するなどの対策が必要  
安易に別オリジンに大切な情報を送ってしまわないようにする仕組み

### <問題>

翌週、新人くんが涙目でこんなことを聞いてきました  
「先輩・・・CORSって分かりますか？なんか「No 'Access-Control-Allow-Origin' header is present on the requested resource」ってエラーが出てきて、リクエストが送られなくて・・・どうすればいいんでしょうか？」  
新人くんに説明してあげてください  

### <回答>

サーバ側でcorsが許可されていない  
サーバ側の`Access-Control-Allow-Origin`を設定すればよい  
外部APIの利用などサーバ側を自分で触ることができなければ、中継サーバを立てて、サーバ経由でリクエストを行う  
corsはjavascriptからのリクエストに対する成約のため、サーバからのリクエストでは関係なく取得できる