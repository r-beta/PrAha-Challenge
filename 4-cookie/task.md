## 課題１（質問）

- ### クッキーとは何でしょうか？「Set-cookie」「ヘッダ」「サーバ」「ブラウザ」という単語を使って、クッキーの仕組みを説明してみてください

クッキーとはブラウザに保存される値のこと。  
サーバから送られるレスポンスヘッダに"Set-cookie"が指定してあると、ブラウザがそれを保存し、サーバに送るリクエストに添加する。  
それを受け取ってサーバは、ユーザの判別や、ログイン状態の判定、簡易なデータベースの代わりなどに利用する。

- ### www.hoge.comで発行されたクッキーは、www.fuga.comにも送信されるでしょうか？その理由を説明してください

されない。  
cookie は同一ドメインにしか送信されない。  
もし、他のドメインにも送信されたら、リクエストのたびに大量の不要なデータが送信され、重くなる。  
また、セッション情報など秘匿な情報も他者に渡ってしまう。  
ただし、www.hoge.com上のwww.fuga.comページのリンクをクリックした場合は送信されることもある

- ### hoge.com:8080 のクッキーは hoge.com:9090 にも送信されるでしょうか？

送信される。  
cookie はポートの違いを識別せずに送信するため、別ポートに信用できないサービスを置くべきではない。

- ### www.hoge.comで発行されたクッキーは、www.api.hoge.comにも送信されるでしょうか？

送信されない。

- ### クッキーに Domain="hoge.com"を指定した場合、api.hoge.com にもクッキーは送信されるでしょうか？理由を説明してください

送信される。  
`Domain`にドメインを指定することで、そのドメイン下の全てのホストに送信されるようになる。

- ### ブラウザで実行される JavaScript は場合によってはクッキーの値を取得できます。JavaScript からクッキーの値が取得されることを防ぐことは可能でしょうか？どうすれば良いのでしょうか？

可能。`HttpOnly`をつける  
ただし、完全に防げるわけではない模様？  
（突破方法は見つけられなかった）

- ### HTTPS（暗号化）通信の時だけクッキーを送信することは可能でしょうか？どうすれば良いのでしょうか？

可能。`Secure`属性をつける

- ### クッキーに Expires を設定すると、どのように挙動が変わるでしょうか？

`Expires=<date>`を指定することで、cookie の有効期限を設定することができる。  
設定しない場合は、セッションが有効期限となり、ブラウザを閉じると消えるが、  
Expires を指定することで、期限内なら永続的に利用することができる。

- ### SameSite 属性について説明してください

`None` `Lax` `Strict`の３つの値が指定できる。

以前はドメイン A のページからドメイン B のページへのリンクをクリックすると、  
そのときの GET リクエストにドメイン A の cookie が含まれるという仕様だったが、  
セキュリティなどの面から、SameSite 属性ができた。

`None`を指定すると、従来どおり別ドメインに cookie が送信される  
`Lax`を指定すると、GET リクエストのときのみ cookie が送信される  
`Strict`を指定すると、別ドメインには cookie は送信されない

2020 年 2 月に Chrome のデフォルトで設定される`SameSite`属性が`Lax`になったらしい？  
その後、コロナウイルスの関係でロールバックされた  
https://www.chromium.org/updates/same-site

初期値を用いるのは挙動が変わる可能性があるので、指定したほうが良い。

- ### クッキーに格納しない方が良い情報の例を、3 つ以上挙げてください

- ### クッキーはローカルストレージと混同されることが多々あります。クッキーを使うべきタイミングと、ローカルストレージを使うべきタイミングを挙げてみてください

ローカルストレージは Cookie よりも保存容量が多く、毎回リクエストヘッダに含まれないため使い勝手が良い  
基本的にはローカルストレージを利用する。ただし、HTML5 以上でしか仕様できない。  
Cookie は HTML4 にも対応しており、古いブラウザでも扱うことができるため、古い IE などにも対応する場合は Cookie を仕様する

- ### stack overflow のような WEB 掲示板サービスを開発しているとしましょう。XSS（クロスサイトスクリプティング）により、他ユーザのクッキー情報が抜き出される仕組みを説明してください。どのような対策が考えられますか？

## 課題２（クイズ）

### クッキーに関するクイズを作成してください

### サードパーティクッキーについて説明しなさい

参考文献

https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Set-Cookie
